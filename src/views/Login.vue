<template>
  <div class="container">
    <div class="card">
      <h2 class="title">ุชุณุฌูู ุงูุฏุฎูู</h2>

      <!-- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู -->
      <label class="label">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
      <input
        type="email"
        v-model="email"
        placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"
        class="input"
      />

      <!-- ูููุฉ ุงููุฑูุฑ -->
      <label class="label">ูููุฉ ุงููุฑูุฑ</label>
      <div class="input-box">
        <input
          :type="showPassword ? 'text' : 'password'"
          v-model="password"
          placeholder="ูููุฉ ุงููุฑูุฑ"
          class="input"
        />
        <span class="toggle" @click="togglePassword">
          {{ showPassword ? "ุฅุฎูุงุก" : "ุฅุธูุงุฑ" }}
        </span>
      </div>

      <!-- ุฒุฑ ุชุณุฌูู ุงูุฏุฎูู ูุน Loader -->
      <button class="btn" @click="loginUser" :disabled="loading">
        <span v-if="!loading">ุชุณุฌูู ุงูุฏุฎูู</span>
        <span v-else class="loader"></span>
      </button>

      <p class="link">
        ููุณ ูุฏูู ุญุณุงุจุ
        <router-link to="/register">ุฅูุดุงุก ุญุณุงุจ</router-link>
      </p>
    </div>
  </div>

  <!-- Popup ุฅุนูุงู -->
  <div id="companyAd" class="ad-overlay" v-if="showAd">
    <div class="ad-box">
      <h2>ุฅุนูุงู</h2>

      <div class="ad-content">
        <p>
          ๐๐๐๐ ูุฑุญุจุง ุจุงูุฌููุน! ุชุฃุณุณุช Mall of the world ูู ุณูุบุงููุฑุฉ ูู 20 ุฃุบุณุทุณ 2021 ูููุฑูุง ุญุงูููุง ูู ููุทูุฉ ุงูุฃุนูุงู ุงููุฑูุฒูุฉ ูู ุณูุบุงููุฑุฉ. ูุญู ุดุฑูุฉ ุงุณุชุซูุงุฑ ูู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ ูุน ูุฑูู ุชููู ููู ูููุฉ ูุงููุฉ ูููุฉ.
          <br>
          ูุชุนุงูู Mall of the world ูุน ุนุดุฑุงุช ุดุฑูุงุช ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ ูุซู Amazon ู eBay ู Tiktok ู Aliexpress ู Alibaba ู Shopee ุ ุฅูุฎ. ููุณุงุนุฏุฉ ุงูุชุฌุงุฑ ุนูู ุฒูุงุฏุฉ ูุจูุนุงุช ุงูููุชุฌุงุช ุงูุฎุงุตุฉ ุจูู ุ ููููููุง ุฃูุถูุง ุชุญููู ุฃุฑุจุงุญ ููู. ุนูุฏูุง ุชุชุตุงุนุฏ ุนูู ููุตุชูุง ุ ุชุดุงุฑู ูู ูุณุงุนุฏุฉ ุงูุจุงุฆุนูู ุนูู ุฒูุงุฏุฉ ุงููุจูุนุงุช ุ ุจุญูุซ ููููู ุฃูุถูุง ูุณุจ ุงููุงู ูููุง. ุญุชู ูุชููู ุงูุฌููุน ูู ุฅุนุงุฏุฉ ุงูุดุญู ุจุซูุฉ ุ ูุฐุง ูุดุฑูุน ุฌูุฏ ูุฌูู ุงูุฃููุงู. ๐๐๐
          <br><br>
          ๐1: ุงูุญุฏ ุงูุฃุฏูู ููุจูุบ ุฅุนุงุฏุฉ ุงูุดุญู: 12 USDT ุ ุงูุญุฏ ุงูุฃุฏูู ููุณุญุจ ุงูููุฏู: 3 USDT
          <br>
          ๐ฐ2: ุชุณุชุซูุฑ ุงูููุตุฉ ุนูู ูุณุชูู ุงูุนุงูู ุ ูุฐุง ูุฅู ุงูุงุณุชุซูุงุฑ ูุฏุนู ููุท ุฅุนุงุฏุฉ ุดุญู ุงูุนููุฉ ุงููุดูุฑุฉ.
          <br>
          ๐3: ููุช ุฅุนุงุฏุฉ ุชุนููู ุงููููุฉ ูู ุงูุณุงุนุฉ 12 ุธูุฑุงู ูู ุณูุบุงููุฑุฉ. ููููู ุงูุญุตูู ุนูู ุงูุฑุจุญ ูู ุฎูุงู ุงุณุชููุงู ุฃูุงูุฑ ุงูุชุงุฌุฑ ูู ููู (ูุฑุฉ ูุงุญุฏุฉ ูู ุงูููู ุ ุตุงูุญุฉ ููุฏุฉ 365 ููููุง).
          <br>
          ๐ฏ4: ููููู ุณุญุจ ุงูููุฏ ูุฑุฉ ูุงุญุฏุฉ ููุท ูู ุงูููู ุ ูุง ููุฌุฏ ุญุฏ ุฒููู ุ ููููู ุณุญุจ ุงูููุฏ ูู ุฃู ููุช ุ ูููุช ุงูุงูุณุญุงุจ ูู 1 ุฅูู 5 ุฏูุงุฆู ุ ูุงูุญุฏ ุงูุฃุฏูู ููุจูุบ ุงูุณุญุจ ูู 3 USDT ุ ููุง ููุฌุฏ ุญุฏ ุฃุนูู.
          <br><br>
          ุนูุฏูุง ูุตู ูุจูุบ ุฅุนุงุฏุฉ ุงูุดุญู ุฅูู ุงููุจูุบ ุงูููุงุจู ุงูุชุงูู ุ ุณูุชู ุชุฑููุฉ ุงูุญุณุงุจ ุชููุงุฆููุง ุฅูู VIP. ูููุง ุฒุงุฏุช ูุจูุบ ุฅุนุงุฏุฉ ุงูุดุญู ุ ูููุง ุฒุงุฏ ุนุฏุฏ USDT ูู ุงูููู!
          <br><br>
          ๐vip1: ุฅุนุงุฏุฉ ุดุญู 12 USDT ุ ุงูุฅูุฑุงุฏุงุช ุงูููููุฉ 3 USDT
          <br>
          ๐vip2: ุฅุนุงุฏุฉ ุงูุดุญู 52 USDT ุ ุงูุฏุฎู ุงููููู 13 USDT
          <br>
          ๐vip3: ุฅุนุงุฏุฉ ุดุญู 100 USDT ุ ุงูุฏุฎู ุงููููู 26 USDT
          <br>
          ๐vip4: ุฅุนุงุฏุฉ ุดุญู 300 USDT ุ ุงูุฏุฎู ุงููููู 82 USDT
          <br>
          ๐VIP5: ุฅุนุงุฏุฉ ุดุญู 500 USDT ุ ุงูุฏุฎู ุงููููู 145 USDT
          <br>
          ๐vip6: ุฅุนุงุฏุฉ ุดุญู 1500 USDT ุ ุงูุฏุฎู ุงููููู 479 USDT
          <br>
          ๐VIP7: ุฅุนุงุฏุฉ ุดุญู 3000 USDT ุ ุงูุฏุฎู ุงููููู 1078 USDT
          <br>
          ๐VIP8: ุฅุนุงุฏุฉ ุดุญู 5000 USDT ุ ุงูุฏุฎู ุงููููู 2000 USDT
          <br>
          ๐vip9: ุฅุนุงุฏุฉ ุดุญู 10000 USDT ุ ุงูุฏุฎู ุงููููู USDT
          <br>
          ๐VIP10: ุฅุนุงุฏุฉ ุดุญู 30000 USDT ุ ุงูุฏุฎู ุงููููู 17699 USDT
          <br>
          ๐VIP11: ุฅุนุงุฏุฉ ุดุญู 90ุ000 ุฏููุงุฑ ุฃูุฑููู ุ ุงูุฏุฎู ุงููููู 81ุ818 USDT
          <br><br>
          ูููู ูููุณุชุฎุฏููู Mall of the world ุงูุชุฑููุฌ ููุธุงููุง ุงูุฃุณุงุณู ูู ุฎูุงู ุฑูุงุจุท ุงูุชูุตูุฉ ูุฏุนูุฉ ุฃุตุฏูุงุฆู ููุงูุถูุงู ุฅูููุง ุนูู Facebook ู Twitter ู Instagram ู YouTube ู Tiktok ู Kaokao ู WhatsApp ู Telegram. ุนูุฏูุง ูุณุฌู ุดุฎุต ูุง ูููุชูู ูู Top-Up ุ ุชุญุตู ุนูู ููุงูุฃุฉ ุชุตู ุฅูู 9 ูช.
          <br><br>
          ๐คteam ุงููุณุชูู 3 ุฅุนุงุฏุฉ ุดุญู ููุงูุฃุฉ ุชุตู ุฅูู 9 ูช
          <br>
          ๐คlevel 1 ููุงูุฃุฉ ุฅุนุงุฏุฉ ุดุญู ุงูุฃุนุถุงุก: 6 ูช
          <br>
          ๐คlevel 2 ููุงูุฃุฉ ุฅุนุงุฏุฉ ุดุญู ุงูุฃุนุถุงุก: 2 ูช
          <br>
          ๐คlevel 3 ููุงูุฃุฉ ุฅุนุงุฏุฉ ุดุญู ุงูุฃุนุถุงุก: 1 ูช
          <br>
          ๐คteam ุฅุนุงุฏุฉ ุดุญู ุงููุณุชูู ุงูุฃูู ุงูุจุงูุบ 1000 ุฏููุงุฑ ุฃูุฑููู ุ ูููููู ุงูุญุตูู ุนูู 60 USDT
          <br>
          ๐คteam ุฅุนุงุฏุฉ ุงูุดุญู ุงูุซุงููู ุงูุจุงูุบ 1000 ุฏููุงุฑ ุฃูุฑููู ุ ููููู ุงูุญุตูู ุนูู 20 USDT
          <br>
          ๐คteam ุงููุณุชูู 3 ุฅุนุงุฏุฉ ุดุญู 1000 USDT ุ ูููููู ุงูุญุตูู ุนูู 10 USDT
        </p>
      </div>

      <button @click="closeAd">ุฃูุง ุฃุนุฑู</button>
    </div>
  </div>

</template>

<script>
import { getAuth, signInWithEmailAndPassword } from "firebase/auth";
import { doc, getDoc } from "firebase/firestore";

// โ ุงููุณุงุฑ ุงูุตุญูุญ
import { db } from "../firebase";

// โ ุงููุณุงุฑ ุงูุตุญูุญ ููุฑูุชุฑ
import router from "../router";

export default {
  data() {
    return {
      email: "",
      password: "",
      showPassword: false,
      loading: false,
      showAd: false,  // ุชุญุฏูุฏ ุญุงูุฉ ุธููุฑ ุงูุฅุนูุงู
    };
  },

  methods: {
    togglePassword() {
      this.showPassword = !this.showPassword;
    },

    async loginUser() {
      if (!this.email || !this.password) {
        return alert("ูุฑุฌู ุชุนุจุฆุฉ ุงูุญููู");
      }

      this.loading = true;

      try {
        const auth = getAuth();

        // ุชุณุฌูู ุงูุฏุฎูู
        await signInWithEmailAndPassword(auth, this.email, this.password);

        const user = auth.currentUser;
        if (!user) {
          alert("ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน");
          return;
        }

        // ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู
        const userRef = doc(db, "users", user.uid);
        const userSnap = await getDoc(userRef);

        // ๐ฅ ุงูุชุญูู ูู ุงูุญุธุฑ
        if (userSnap.exists() && userSnap.data().blocked === true) {
          alert("๐ซ ุญุณุงุจู ูุญุธูุฑ. ูุฑุฌู ุงูุชูุงุตู ูุน ุงูุฏุนู.");
          await auth.signOut();
          return;
        }

        // ๐ฅ ุชุณุฌูู ุฏุฎูู ุงูุฃุฏูู
        if (
          this.email === "azad.333388@gmail.com" &&
          this.password === "admin0997408001AZAD"
        ) {
          return router.push("/admin");
        }

        // ๐ฅ ุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏู ุงูุนุงุฏู
        router.push("/home");

        // ุฅุธูุงุฑ ุงูุฅุนูุงู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู
        this.showAd = true; // ุชูุนูู ุนุฑุถ ุงูุฅุนูุงู

      } catch (error) {
        alert("ุฎุทุฃ: " + error.message);
      } finally {
        this.loading = false;
      }
    },

    closeAd() {
      this.showAd = false; // ุฅุบูุงู ุงูุฅุนูุงู
    }
  },
};
</script>

<style scoped>
.container {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40px;
  min-height: 100vh;
  background: linear-gradient(#0d6efd, #6bb4ff);
}

.card {
  background: white;
  width: 90%;
  max-width: 380px;
  padding: 25px;
  border-radius: 20px;
  box-shadow: 0 4px 12px #0003;
}

.title {
  text-align: center;
  margin-bottom: 20px;
  font-weight: bold;
}

.label {
  display: block;
  margin-bottom: 5px;
  font-weight: 600;
}

.input {
  width: 100%;
  padding: 12px;
  margin-bottom: 15px;
  border-radius: 10px;
  border: 1px solid #ccc;
}

.input-box {
  position: relative;
}

.toggle {
  position: absolute;
  left: 15px;
  top: 12px;
  color: #0d6efd;
  cursor: pointer;
  font-size: 14px;
}

.btn {
  width: 100%;
  padding: 12px;
  border: none;
  background: #007bff;
  color: white;
  border-radius: 8px;
  font-size: 18px;
  cursor: pointer;
}

.link {
  text-align: center;
  margin-top: 15px;
}

.loader {
  width: 20px;
  height: 20px;
  border: 3px solid #fff;
  border-top: 3px solid transparent;
  border-radius: 50%;
  display: inline-block;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

button:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}

/* ุฅุนูุงู */
.ad-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.ad-box {
  background: #eaf2ff;
  width: 90%;
  max-width: 400px;
  margin: 15% auto;
  border-radius: 15px;
  padding: 15px;
  text-align: center;
}

.ad-box h2 {
  background: #3b82f6;
  color: white;
  padding: 10px;
  border-radius: 10px;
}

.ad-content {
  max-height: 250px;
  overflow-y: auto;
  margin: 10px 0;
  font-size: 14px;
}

.ad-box button {
  background: #3b82f6;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  cursor: pointer;
}
</style>
